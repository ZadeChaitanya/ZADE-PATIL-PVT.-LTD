<%- include("navbar.ejs") %>

     <% if (cart.length> 0) { %>
          <div class="container my-5">
               <h2 class="fw-semibold mb-4">Your Cart</h2>
               <div class="row">
                    <% var total_price=0 %>
                         <!-- LEFT CART ITEMS -->
                         <div class="col-lg-8">
                              <% cart.map((val,i)=>{ %>
                                   <div class="cart-item shadow-lg row align-items-start">
                                        <!-- IMAGE -->
                                        <div class="col-md-4">
                                             <img src="/uploads/<%= val.product_image1 %>"
                                                  class="img-fluid w-100 cart-image"
                                                  style="height:240px; object-fit:cover;">
                                        </div>
                                        <!-- DETAILS -->
                                        <div class="col-md-8">
                                             <h5 class="fw-bold mb-2">
                                                  <%= val.product_name %>
                                             </h5>
                                             <p class="text-muted small mb-2">
                                                  <%= val.product_details %>
                                             </p>
                                             <p class="mb-1">
                                                  Size: <span class="fw-semibold">
                                                       <%= val.product_size %>
                                                  </span>
                                             </p>
                                             <p class="fw-bold text-success fs-5 mb-1">
                                                  â‚¹ <%= val.product_price %> /-
                                                       <span
                                                            class="text-danger text-decoration-line-through small ms-2">
                                                            â‚¹ <%= val.product_duplicate_price %> /-
                                                       </span>
                                             </p>
                                             <p class="fw-semibold fs-6 text-secondary mb-3">
                                                  Subtotal:
                                                  <span class="text-dark fw-bold">â‚¹ <%= val.product_price * val.quantity
                                                            %>
                                                            /-</span>
                                             </p>
                                             <!-- QUANTITY CONTROL -->
                                             <div class="align-items-center">
                                                  <a href="/decrease_qnt/<%= val.id %>">
                                                       <button class="btn btn-danger ">âˆ’</button>
                                                  </a>
                                                  <input class="qty-box mx-2" value="<%= val.quantity %>" type="text">
                                                  <a href="/increase_qnt/<%= val.id %>">
                                                       <button class="btn btn-info ">+</button>
                                                  </a>

                                                  <a href="/delete_cart/<%= val.id %>"><button
                                                            class="btn btn-dark p-3 float-end"> REMOVE </button></a>
                                             </div>
                                        </div>
                                   </div>
                                   <% total_price +=val.product_price * val.quantity %>
                                        <% }) %>
                         </div>
                         <!-- RIGHT SUMMARY -->
                         <div class="col-lg-4">
                              <div class="summary-card">
                                   <h5 class="fw-bold mb-3">Price Summary</h5>
                                   <table class="w-100 table-summary mb-3">
                                        <tbody>
                                             <% cart.map((val,i)=>{ %>
                                                  <tr>
                                                       <td class="text-muted small">
                                                            <%= val.product_name %>
                                                       </td>
                                                       <td class="text-end small">
                                                            â‚¹ <%= val.product_price * val.quantity %> /-
                                                       </td>
                                                  </tr>
                                                  <% }) %>
                                        </tbody>
                                        <tfoot class="border-top">
                                             <tr>
                                                  <th class="pt-2">Total</th>
                                                  <th class="pt-2 text-end text-success fw-bold">
                                                       â‚¹ <%= total_price %> /-
                                                  </th>
                                             </tr>
                                        </tfoot>
                                   </table>
                                   <a href="/checkout"><button class="btn btn-dark w-100 py-2 fs-6">
                                             Proceed to Checkout
                                        </button></a>


                              </div>
                         </div>
                         <!-- <div>
                              Select Payment Mode 
                              <select class="form-control" name="payment_mode" id="">
                                   <option value="online"> SELECT </option>
                                   <option value="online">Online Payment </option>
                                   <option value="cashon"> Cash On Delivery </option>
                              </select>

                         </div> -->
               </div>
               <div class="col-12 mt-4">

                    <div class="row py-4 px-3 border-top shadow-sm bg-white align-items-center"
                         style="position: sticky; bottom: 0; z-index: 50;">

                         <!-- TOTAL -->
                         <div class="col-md-12 text-end">
                              <h1 class="fw-bold mb-0 text-dark-emphasis">
                                   Grand Total : <span class="text-danger ">â‚¹ <%= total_price %> /-</span>
                              </h1>
                         </div>

                         <!-- BUTTON -->
                         <div class="col-md-12 text-end mt-3 mt-md-0">
                              <button class="btn px-5 py-3 fs-4 text-white shadow-lg"
                                   style="background-color: rgb(251,100,27); border-radius: 4px;">
                                   Place Order
                              </button>
                         </div>

                    </div>

               </div>

          </div>

          <% } else { %>
               <div class="container">
                    <div class="row">
                         <div class="col-md-12 text-center">
                              <h1>Your Cart is Empty </h1>
                              <a href="/shop">
                                   <button class="btn px-5 py-3 fs-4 text-white shadow-lg"
                                        style="background-color: rgba(251, 102, 27, 0.9); border-radius: 4px;"> ðŸ›’ Let`s DO Shopping ðŸ›’ </button>
                              </a>
                         </div>
                    </div>
               </div>
               <% } %>

                    <%- include("footer.ejs") %>